steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-be3c9b3c-bd48-4e86-be0e-83a15660f408:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 213f24e6-088c-4bfe-8a35-5be2ab596628
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 21608117-275f-4d21-9a80-742db429a078
                    stepCounter: 2c776f5a-36ba-4cac-8561-dec1811b55d3
                transform: ""
          - columnReference:
              columnCounter: ad5b6b09-59c8-4cc6-9674-dcc3dd33c03f
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ecdbef7e-d748-4a5f-a9a0-a8f9d537f61b
                    stepCounter: ca056394-bd9b-4652-9e53-480f246a0c4d
                transform: ""
          - columnReference:
              columnCounter: 8a8ac427-ea28-4441-9401-4952185a58f0
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ab3bb9d-ed22-4349-84fe-d3d97a90cbfa
                    stepCounter: df27ad37-14c6-4eed-ba37-d703cd8291c5
                transform: ""
          - columnReference:
              columnCounter: e06faf05-e691-4840-b003-c8e129e3c13b
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b7b2d9fa-9cd3-46f8-a75c-3f3e346efb4b
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: d14e024f-f1c9-4bef-839d-42597e7bea5d
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cd1b5881-10c9-4ca8-965b-ed4e3b28007b
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: b2e26f38-46fb-476a-b42d-91f2e6f2833b
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7d52f91c-6015-4a8a-b30b-70eb1360fe46
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 85aad73a-3273-4d14-81ce-64e332547615
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5bb0a002-de12-4b84-bd26-13201667fa47
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 33d4155c-a4dc-4446-8384-0810c5014003
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2e0bd788-e8c4-4aae-9667-ed45875d349b
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 06419285-a00c-41b9-ab25-e2737ba3b081
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dd9416f6-bc58-4c2e-a33f-91c359598663
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: a016fb5c-2d25-4dcb-993d-4c118f42f32f
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d25356bc-f9ec-4a6f-b57b-f098c9119850
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 1894146e-dbd5-47af-ad5c-973933045821
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: acf3d48a-3940-4b26-97b9-caa4be895a70
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 4bce2c9a-e28c-4976-ac0c-72d2801e87e9
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b6adac5c-c37b-431b-9ea3-880818517aba
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: ae03cbea-571c-48a9-8a86-70d12604e284
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2bad8d91-bc65-48ac-9734-9f7ae43da8bb
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: fb8c4e10-0a80-4e47-83df-7f160eacd598
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a8bab919-bdfd-4ea7-a3b2-16477d58c027
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: b2621fa6-d6cd-4fc8-8993-8ed59eb63148
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 084a77ed-954a-4fa6-9d55-9727cc03ce88
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: ca227069-3af9-4bdf-9db2-4ab3b7385977
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2a23a9af-8938-41bf-8d23-ca2ba8664e48
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: db450ef0-414e-46eb-b828-f7d8381c5689
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8f751c84-fec1-4052-a8d0-ef7876cc6e51
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: ea893024-433b-4ee0-bdb6-d18c7a4c8af9
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 35032317-0026-40d9-99b0-724570650936
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: f748d6d8-073d-4f3b-b9df-b0a06a805344
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a02b4d61-47cd-492a-a447-4bc97d9eab1e
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 33b1a883-b5af-42e8-ba0f-ceacc01c5427
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: db8ad32b-b6ce-4c67-aa47-6d7d0e1b025b
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: d374b7eb-ff08-46fd-b8d1-64b60b382cde
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b7155c88-59a0-4d10-bd21-e3f7471b1a9d
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 4cfd8c08-bc55-429f-85ac-ea34c0abbf84
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1b1e7abe-b3bf-4295-92e3-2b7fdec1dc76
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: ec6ce64d-280b-49aa-a81f-38dd47574e63
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ee15e268-4f70-4415-bbc1-9573ed868057
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 8081b78a-b14c-4457-8b1a-bec9c17198f0
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2e266945-dd8a-4eb1-bfc8-0722ad2a61d7
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: d0d504e4-5d9e-46e3-b35d-0488dd1e4604
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a97ea29f-f370-4107-8d45-e7f839fbc447
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 37bcfaf5-4e6d-4d25-8e40-24e23ff8a143
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 32ea0bd5-1385-459c-b6d2-789b820177ec
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: fc16d2ec-74f9-46a4-83fa-8e1dadadbc31
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 051ee646-ef83-4649-b295-706f3a4dda1d
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 07b4b4c2-b6c8-4d0c-aae3-0684b8408c63
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c2481bb6-24a7-4129-af9e-9d6b946d4ad2
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 4dc55e84-a48e-488b-8e75-8aae90a994c6
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 19e3ec71-0a1b-4a90-9285-bd6b049da655
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - columnReference:
              columnCounter: 7be498eb-7c96-4898-bbea-16199b4f6744
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 054bb4ff-a0aa-45d4-a994-37c6599afe36
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 8c9606e8-7a9c-49e4-a393-c56b399d78da
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7a8f4b4d-40e3-4dca-9e59-6b8f99c86fb0
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6c6ee4e1-d9d8-472f-b2dd-bddc756be37b
              stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e57888c4-89a8-4d42-afe2-8931ad9e37dc
                    stepCounter: 58565677-9c25-45d1-9ce3-4047b8f417e9
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 2c776f5a-36ba-4cac-8561-dec1811b55d3
              DIM_PART: ca056394-bd9b-4652-9e53-480f246a0c4d
              DIM_SUPPLIER: df27ad37-14c6-4eed-ba37-d703cd8291c5
              STG_LINEITEM_ORDERS: 58565677-9c25-45d1-9ce3-4047b8f417e9
              STG_PARTSUPP: ecd3c251-26c6-4dac-b2b9-d844792ee495
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN 
                    "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" 
                AND "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: be3c9b3c-bd48-4e86-be0e-83a15660f408
